
<!-- Preload Critical Resources -->
<link rel="preload" href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&family=Inter:wght@300;400;500;600;700&display=swap" as="style" onload="this.onload=null;this.rel='stylesheet'">
<link rel="preload" href="/css/design-system.css" as="style">
<link rel="preload" href="/css/components.css" as="style">

<!-- DNS Prefetch -->
<link rel="dns-prefetch" href="//fonts.googleapis.com">
<link rel="dns-prefetch" href="//www.googletagmanager.com">
<link rel="dns-prefetch" href="//www.google-analytics.com">

<!-- Head Scripts - Analytics, Tracking, etc. -->

<%
// Use analytics configuration passed from server
// const analyticsConfig is passed from the route handler
%>

<!-- Google Analytics (GA4) -->
<% if (analyticsConfig.googleAnalytics.enabled && analyticsConfig.googleAnalytics.measurementId !== 'G-XXXXXXXXXX') { %>
<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=<%= analyticsConfig.googleAnalytics.measurementId %>"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', '<%= analyticsConfig.googleAnalytics.measurementId %>', {
    page_title: '<%= title %>',
    page_location: '<%= canonicalUrl %>',
    custom_map: {
      'dimension1': 'city_name',
      'dimension2': 'service_type',
      'dimension3': 'user_type'
    }
  });

  // Enhanced ecommerce for service inquiries
  gtag('config', '<%= analyticsConfig.googleAnalytics.measurementId %>', {
    custom_map: {
      'metric1': 'phone_calls',
      'metric2': 'form_submissions',
      'metric3': 'whatsapp_clicks'
    }
  });
</script>
<% } %>

<!-- Google Tag Manager -->
<% if (analyticsConfig.googleTagManager.enabled && analyticsConfig.googleTagManager.containerId !== 'GTM-XXXXXXX') { %>
<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','<%= analyticsConfig.googleTagManager.containerId %>');</script>
<!-- End Google Tag Manager -->
<% } %>

<!-- Facebook Pixel -->
<% if (analyticsConfig.facebookPixel.enabled && analyticsConfig.facebookPixel.pixelId !== 'YOUR_PIXEL_ID') { %>
<script>
!function(f,b,e,v,n,t,s)
{if(f.fbq)return;n=f.fbq=function(){n.callMethod?
n.callMethod.apply(n,arguments):n.queue.push(arguments)};
if(!f._fbq)f._fbq=n;n.push=n;n.loaded=!0;n.version='2.0';
n.queue=[];t=b.createElement(e);t.async=!0;
t.src=v;s=b.getElementsByTagName(e)[0];
s.parentNode.insertBefore(t,s)}(window, document,'script',
'https://connect.facebook.net/en_US/fbevents.js');
fbq('init', '<%= analyticsConfig.facebookPixel.pixelId %>');
fbq('track', 'PageView');
</script>
<noscript><img height="1" width="1" style="display:none"
src="https://www.facebook.com/tr?id=<%= analyticsConfig.facebookPixel.pixelId %>&ev=PageView&noscript=1"
/></noscript>
<% } %>

<!-- Structured Data for Local Business -->
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "LocalBusiness",
  "name": "IT-ERA",
  "description": "Assistenza informatica professionale 24/7 per aziende in Lombardia",
  "url": "https://it-era.vercel.app",
  "telephone": "+39 039 888 2041",
  "email": "info@it-era.it",
  "address": {
    "@type": "PostalAddress",
    "addressLocality": "Vimercate",
    "addressRegion": "Lombardia",
    "addressCountry": "IT"
  },
  "geo": {
    "@type": "GeoCoordinates",
    "latitude": "45.6167",
    "longitude": "9.3667"
  },
  "openingHours": [
    "Mo-Fr 08:00-18:00"
  ],
  "serviceArea": {
    "@type": "State",
    "name": "Lombardia"
  },
  "priceRange": "€€",
  "image": "https://it-era.vercel.app/images/logo.png",
  "sameAs": [
    "https://www.facebook.com/itera",
    "https://www.linkedin.com/company/it-era"
  ]
}
</script>

<!-- Preconnect to external domains for performance -->
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">

<!-- DNS Prefetch for better performance -->
<link rel="dns-prefetch" href="//fonts.googleapis.com">
<link rel="dns-prefetch" href="//www.google-analytics.com">

<!-- Favicon and App Icons -->
<link rel="icon" type="image/x-icon" href="/favicon.ico">
<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="manifest" href="/site.webmanifest">

<!-- Meta tags for better SEO and social sharing -->
<meta name="robots" content="index, follow">
<meta name="author" content="IT-ERA Team">
<meta name="theme-color" content="#0066cc">

<!-- Open Graph Meta Tags -->
<meta property="og:site_name" content="IT-ERA">
<meta property="og:locale" content="it_IT">
<meta property="og:image" content="https://it-era.vercel.app/images/og-image.jpg">
<meta property="og:image:width" content="1200">
<meta property="og:image:height" content="630">

<!-- Twitter Card Meta Tags -->
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:site" content="@itera">
<meta name="twitter:creator" content="@itera">
<meta name="twitter:image" content="https://it-era.vercel.app/images/og-image.jpg">
